---
Address:
  ENUM:
    0:
      Burn: UNIT
    1:
      Account:
        NEWTYPE:
          TYPENAME: ChainId
Amount:
  NEWTYPESTRUCT: U64
Balance:
  NEWTYPESTRUCT: I128
Certificate:
  STRUCT:
    - value:
        TYPENAME: Value
    - signatures:
        SEQ:
          TUPLE:
            - TYPENAME: PublicKeyBytes
            - TYPENAME: Signature
ChainId:
  NEWTYPESTRUCT:
    SEQ:
      TYPENAME: SequenceNumber
ChainInfo:
  STRUCT:
    - chain_id:
        TYPENAME: ChainId
    - manager:
        TYPENAME: ChainManager
    - balance:
        TYPENAME: Balance
    - next_sequence_number:
        TYPENAME: SequenceNumber
    - queried_committee:
        OPTION:
          TYPENAME: Committee
    - queried_sent_certificates:
        SEQ:
          TYPENAME: Certificate
    - count_received_certificates: U64
    - queried_received_certificates:
        SEQ:
          TYPENAME: Certificate
ChainInfoQuery:
  STRUCT:
    - chain_id:
        TYPENAME: ChainId
    - check_next_sequence_number:
        OPTION:
          TYPENAME: SequenceNumber
    - query_committee: BOOL
    - query_sent_certificates_in_range:
        OPTION:
          TYPENAME: SequenceNumberRange
    - query_received_certificates_excluding_first_nth:
        OPTION: U64
ChainInfoResponse:
  STRUCT:
    - info:
        TYPENAME: ChainInfo
    - signature:
        OPTION:
          TYPENAME: Signature
ChainManager:
  ENUM:
    0:
      None: UNIT
    1:
      Single:
        NEWTYPE:
          TYPENAME: SingleOwnerManager
    2:
      Multi:
        NEWTYPE:
          TYPENAME: MultiOwnerManager
ChainState:
  STRUCT:
    - id:
        TYPENAME: ChainId
    - state:
        TYPENAME: ExecutionState
    - next_sequence_number:
        TYPENAME: SequenceNumber
    - confirmed_log:
        SEQ:
          TYPENAME: HashValue
    - received_log:
        SEQ:
          TYPENAME: HashValue
    - received_index:
        MAP:
          KEY:
            TYPENAME: ChainId
          VALUE:
            TYPENAME: SequenceNumber
    - keep_sending:
        SEQ:
          TYPENAME: HashValue
    - received_keys:
        SEQ:
          TYPENAME: HashValue
Committee:
  STRUCT:
    - voting_rights:
        MAP:
          KEY:
            TYPENAME: PublicKeyBytes
          VALUE: U64
    - total_votes: U64
CrossShardRequest:
  ENUM:
    0:
      UpdateRecipient:
        STRUCT:
          - committee:
              TYPENAME: Committee
          - certificate:
              TYPENAME: Certificate
    1:
      ConfirmUpdatedRecipient:
        STRUCT:
          - chain_id:
              TYPENAME: ChainId
          - hash:
              TYPENAME: HashValue
Error:
  ENUM:
    0:
      InactiveChain:
        NEWTYPE:
          TYPENAME: ChainId
    1:
      InvalidOwner: UNIT
    2:
      UnexpectedSequenceNumber: UNIT
    3:
      InvalidSequenceNumber: UNIT
    4:
      PreviousRequestMustBeConfirmedFirst: UNIT
    5:
      MissingEarlierConfirmations:
        STRUCT:
          - current_sequence_number:
              TYPENAME: SequenceNumber
    6:
      SequenceOverflow: UNIT
    7:
      SequenceUnderflow: UNIT
    8:
      AmountOverflow: UNIT
    9:
      AmountUnderflow: UNIT
    10:
      BalanceOverflow: UNIT
    11:
      BalanceUnderflow: UNIT
    12:
      InvalidSignature:
        STRUCT:
          - error: STR
          - type_name: STR
    13:
      InvalidSigner: UNIT
    14:
      CertificateRequiresQuorum: UNIT
    15:
      CertificateValidatorReuse: UNIT
    16:
      InvalidCertificate: UNIT
    17:
      InvalidChainInfoResponse: UNIT
    18:
      IncorrectTransferAmount: UNIT
    19:
      InsufficientFunding:
        STRUCT:
          - current_balance:
              TYPENAME: Balance
    20:
      InvalidNewChainId:
        NEWTYPE:
          TYPENAME: ChainId
    21:
      InsufficientRound:
        NEWTYPE:
          TYPENAME: RoundNumber
    22:
      HasLockedOperation:
        NEWTYPE:
          TYPENAME: Operation
    23:
      CertificateNotFound: UNIT
    24:
      InvalidCrossShardRequest: UNIT
    25:
      InvalidRequestOrder: UNIT
    26:
      ClientErrorWhileProcessingRequestOrder: UNIT
    27:
      ClientErrorWhileRequestingCertificate: UNIT
    28:
      WrongShard: UNIT
    29:
      InvalidDecoding: UNIT
    30:
      UnexpectedMessage: UNIT
    31:
      ClientIoError:
        STRUCT:
          - error: STR
    32:
      StorageIoError:
        STRUCT:
          - error: STR
    33:
      StorageBcsError:
        STRUCT:
          - error: STR
    34:
      MissingCertificate:
        STRUCT:
          - hash:
              TYPENAME: HashValue
ExecutionState:
  STRUCT:
    - committee:
        OPTION:
          TYPENAME: Committee
    - manager:
        TYPENAME: ChainManager
    - balance:
        TYPENAME: Balance
HashValue:
  NEWTYPESTRUCT:
    TUPLEARRAY:
      CONTENT: U8
      SIZE: 64
MultiOwnerManager:
  STRUCT:
    - owners:
        SEQ:
          TYPENAME: PublicKeyBytes
    - order:
        OPTION:
          TYPENAME: RequestOrder
    - pending:
        OPTION:
          TYPENAME: Vote
    - locked:
        OPTION:
          TYPENAME: Certificate
Operation:
  ENUM:
    0:
      Transfer:
        STRUCT:
          - recipient:
              TYPENAME: Address
          - amount:
              TYPENAME: Amount
          - user_data:
              TYPENAME: UserData
    1:
      OpenChain:
        STRUCT:
          - new_id:
              TYPENAME: ChainId
          - new_owner:
              TYPENAME: PublicKeyBytes
    2:
      CloseChain: UNIT
    3:
      ChangeOwner:
        STRUCT:
          - new_owner:
              TYPENAME: PublicKeyBytes
    4:
      ChangeMultipleOwners:
        STRUCT:
          - new_owners:
              SEQ:
                TYPENAME: PublicKeyBytes
PublicKeyBytes:
  NEWTYPESTRUCT:
    TUPLEARRAY:
      CONTENT: U8
      SIZE: 32
Request:
  STRUCT:
    - chain_id:
        TYPENAME: ChainId
    - operation:
        TYPENAME: Operation
    - sequence_number:
        TYPENAME: SequenceNumber
    - round:
        TYPENAME: RoundNumber
RequestOrder:
  STRUCT:
    - request:
        TYPENAME: Request
    - owner:
        TYPENAME: PublicKeyBytes
    - signature:
        TYPENAME: Signature
RoundNumber:
  NEWTYPESTRUCT: U64
SequenceNumber:
  NEWTYPESTRUCT: U64
SequenceNumberRange:
  STRUCT:
    - start:
        TYPENAME: SequenceNumber
    - limit:
        OPTION: U64
SerializedMessage:
  ENUM:
    0:
      RequestOrder:
        NEWTYPE:
          TYPENAME: RequestOrder
    1:
      Certificate:
        NEWTYPE:
          TYPENAME: Certificate
    2:
      ChainInfoQuery:
        NEWTYPE:
          TYPENAME: ChainInfoQuery
    3:
      Vote:
        NEWTYPE:
          TYPENAME: Vote
    4:
      ChainInfoResponse:
        NEWTYPE:
          TYPENAME: ChainInfoResponse
    5:
      Error:
        NEWTYPE:
          TYPENAME: Error
    6:
      CrossShardRequest:
        NEWTYPE:
          TYPENAME: CrossShardRequest
Signature:
  NEWTYPESTRUCT:
    TUPLEARRAY:
      CONTENT: U8
      SIZE: 64
SingleOwnerManager:
  STRUCT:
    - owner:
        TYPENAME: PublicKeyBytes
    - pending:
        OPTION:
          TYPENAME: Vote
UserData:
  NEWTYPESTRUCT:
    OPTION:
      TUPLEARRAY:
        CONTENT: U8
        SIZE: 32
Value:
  ENUM:
    0:
      Validated:
        STRUCT:
          - request:
              TYPENAME: Request
    1:
      Confirmed:
        STRUCT:
          - request:
              TYPENAME: Request
Vote:
  STRUCT:
    - value:
        TYPENAME: Value
    - validator:
        TYPENAME: PublicKeyBytes
    - signature:
        TYPENAME: Signature

