<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Policy that decides which nodes and shards to contact for each request."><title>LoadBalancingPolicy in scylla::policies::load_balancing - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-6c3ea77c.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="scylla" data-themes="" data-resource-suffix="" data-rustdoc-version="1.86.0 (05f9846f8 2025-03-31)" data-channel="1.86.0" data-search-js="search-581efc7a.js" data-settings-js="settings-6dad6058.js" ><script src="../../../static.files/storage-3a5871a4.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-4d63596a.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../scylla/index.html">scylla</a><span class="version">1.1.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Load<wbr>Balancing<wbr>Policy</a></h2><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.fallback" title="fallback">fallback</a></li><li><a href="#tymethod.name" title="name">name</a></li><li><a href="#tymethod.pick" title="pick">pick</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.on_request_failure" title="on_request_failure">on_request_failure</a></li><li><a href="#method.on_request_success" title="on_request_success">on_request_success</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In scylla::<wbr>policies::<wbr>load_<wbr>balancing</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">scylla</a>::<wbr><a href="../index.html">policies</a>::<wbr><a href="index.html">load_balancing</a></div><h1>Trait <span class="trait">LoadBalancingPolicy</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/scylla/policies/load_balancing/mod.rs.html#71-101">Source</a> </span></div><pre class="rust item-decl"><code>pub trait LoadBalancingPolicy:
    <a class="trait" href="https://doc.rust-lang.org/1.86.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>
    + <a class="trait" href="https://doc.rust-lang.org/1.86.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>
    + <a class="trait" href="https://doc.rust-lang.org/1.86.0/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> {
    // Required methods
    fn <a href="#tymethod.pick" class="fn">pick</a>&lt;'a&gt;(
        &amp;'a self,
        request: &amp;'a <a class="struct" href="struct.RoutingInfo.html" title="struct scylla::policies::load_balancing::RoutingInfo">RoutingInfo</a>&lt;'_&gt;,
        cluster: &amp;'a <a class="struct" href="../../cluster/struct.ClusterState.html" title="struct scylla::cluster::ClusterState">ClusterState</a>,
    ) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.86.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;(<a class="type" href="../../cluster/type.NodeRef.html" title="type scylla::cluster::NodeRef">NodeRef</a>&lt;'a&gt;, <a class="enum" href="https://doc.rust-lang.org/1.86.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="../../routing/type.Shard.html" title="type scylla::routing::Shard">Shard</a>&gt;)&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.fallback" class="fn">fallback</a>&lt;'a&gt;(
        &amp;'a self,
        request: &amp;'a <a class="struct" href="struct.RoutingInfo.html" title="struct scylla::policies::load_balancing::RoutingInfo">RoutingInfo</a>&lt;'_&gt;,
        cluster: &amp;'a <a class="struct" href="../../cluster/struct.ClusterState.html" title="struct scylla::cluster::ClusterState">ClusterState</a>,
    ) -&gt; <a class="type" href="type.FallbackPlan.html" title="type scylla::policies::load_balancing::FallbackPlan">FallbackPlan</a>&lt;'a&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.name" class="fn">name</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.86.0/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>;

    // Provided methods
    fn <a href="#method.on_request_success" class="fn">on_request_success</a>(
        &amp;self,
        _request: &amp;<a class="struct" href="struct.RoutingInfo.html" title="struct scylla::policies::load_balancing::RoutingInfo">RoutingInfo</a>&lt;'_&gt;,
        _latency: <a class="struct" href="https://doc.rust-lang.org/1.86.0/core/time/struct.Duration.html" title="struct core::time::Duration">Duration</a>,
        _node: <a class="type" href="../../cluster/type.NodeRef.html" title="type scylla::cluster::NodeRef">NodeRef</a>&lt;'_&gt;,
    ) { ... }
<span class="item-spacer"></span>    fn <a href="#method.on_request_failure" class="fn">on_request_failure</a>(
        &amp;self,
        _request: &amp;<a class="struct" href="struct.RoutingInfo.html" title="struct scylla::policies::load_balancing::RoutingInfo">RoutingInfo</a>&lt;'_&gt;,
        _latency: <a class="struct" href="https://doc.rust-lang.org/1.86.0/core/time/struct.Duration.html" title="struct core::time::Duration">Duration</a>,
        _node: <a class="type" href="../../cluster/type.NodeRef.html" title="type scylla::cluster::NodeRef">NodeRef</a>&lt;'_&gt;,
        _error: &amp;<a class="enum" href="../../errors/enum.RequestAttemptError.html" title="enum scylla::errors::RequestAttemptError">RequestAttemptError</a>,
    ) { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Policy that decides which nodes and shards to contact for each request.</p>
<p>When a request is prepared to be sent to ScyllaDB/Cassandra, a <code>LoadBalancingPolicy</code>
implementation constructs a load balancing plan. That plan is a list of
targets (target is a node + an optional shard) to which
the driver will try to send the request. The first elements of the plan are the targets which are
the best to contact (e.g. they might have the lowest latency).</p>
<p>Most requests are sent on the first try, so the request execution layer rarely needs to know more
than one target from plan. To better optimize that case, <code>LoadBalancingPolicy</code> has two methods:
<code>pick</code> and <code>fallback</code>. <code>pick</code> returns the first target to contact for a given request, <code>fallback</code>
returns the rest of the load balancing plan.</p>
<p><code>fallback</code> is called not only if a send to <code>pick</code>ed node failed (or when executing
speculatively), but also if <code>pick</code> returns <code>None</code>.</p>
<p>Usually the driver needs only the first node from load balancing plan (most requests are send
successfully, and there is no need to retry).</p>
<p>This trait is used to produce an iterator of nodes to contact for a given request.</p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">ยง</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.pick" class="method"><a class="src rightside" href="../../../src/scylla/policies/load_balancing/mod.rs.html#73-77">Source</a><h4 class="code-header">fn <a href="#tymethod.pick" class="fn">pick</a>&lt;'a&gt;(
    &amp;'a self,
    request: &amp;'a <a class="struct" href="struct.RoutingInfo.html" title="struct scylla::policies::load_balancing::RoutingInfo">RoutingInfo</a>&lt;'_&gt;,
    cluster: &amp;'a <a class="struct" href="../../cluster/struct.ClusterState.html" title="struct scylla::cluster::ClusterState">ClusterState</a>,
) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.86.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;(<a class="type" href="../../cluster/type.NodeRef.html" title="type scylla::cluster::NodeRef">NodeRef</a>&lt;'a&gt;, <a class="enum" href="https://doc.rust-lang.org/1.86.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="../../routing/type.Shard.html" title="type scylla::routing::Shard">Shard</a>&gt;)&gt;</h4></section></summary><div class="docblock"><p>Returns the first node to contact for a given request.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.fallback" class="method"><a class="src rightside" href="../../../src/scylla/policies/load_balancing/mod.rs.html#80-84">Source</a><h4 class="code-header">fn <a href="#tymethod.fallback" class="fn">fallback</a>&lt;'a&gt;(
    &amp;'a self,
    request: &amp;'a <a class="struct" href="struct.RoutingInfo.html" title="struct scylla::policies::load_balancing::RoutingInfo">RoutingInfo</a>&lt;'_&gt;,
    cluster: &amp;'a <a class="struct" href="../../cluster/struct.ClusterState.html" title="struct scylla::cluster::ClusterState">ClusterState</a>,
) -&gt; <a class="type" href="type.FallbackPlan.html" title="type scylla::policies::load_balancing::FallbackPlan">FallbackPlan</a>&lt;'a&gt;</h4></section></summary><div class="docblock"><p>Returns all contact-appropriate nodes for a given request.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.name" class="method"><a class="src rightside" href="../../../src/scylla/policies/load_balancing/mod.rs.html#100">Source</a><h4 class="code-header">fn <a href="#tymethod.name" class="fn">name</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.86.0/alloc/string/struct.String.html" title="struct alloc::string::String">String</a></h4></section></summary><div class="docblock"><p>Returns the name of load balancing policy.</p>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">ยง</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.on_request_success" class="method"><a class="src rightside" href="../../../src/scylla/policies/load_balancing/mod.rs.html#87">Source</a><h4 class="code-header">fn <a href="#method.on_request_success" class="fn">on_request_success</a>(
    &amp;self,
    _request: &amp;<a class="struct" href="struct.RoutingInfo.html" title="struct scylla::policies::load_balancing::RoutingInfo">RoutingInfo</a>&lt;'_&gt;,
    _latency: <a class="struct" href="https://doc.rust-lang.org/1.86.0/core/time/struct.Duration.html" title="struct core::time::Duration">Duration</a>,
    _node: <a class="type" href="../../cluster/type.NodeRef.html" title="type scylla::cluster::NodeRef">NodeRef</a>&lt;'_&gt;,
)</h4></section></summary><div class="docblock"><p>Invoked each time a request succeeds.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.on_request_failure" class="method"><a class="src rightside" href="../../../src/scylla/policies/load_balancing/mod.rs.html#90-97">Source</a><h4 class="code-header">fn <a href="#method.on_request_failure" class="fn">on_request_failure</a>(
    &amp;self,
    _request: &amp;<a class="struct" href="struct.RoutingInfo.html" title="struct scylla::policies::load_balancing::RoutingInfo">RoutingInfo</a>&lt;'_&gt;,
    _latency: <a class="struct" href="https://doc.rust-lang.org/1.86.0/core/time/struct.Duration.html" title="struct core::time::Duration">Duration</a>,
    _node: <a class="type" href="../../cluster/type.NodeRef.html" title="type scylla::cluster::NodeRef">NodeRef</a>&lt;'_&gt;,
    _error: &amp;<a class="enum" href="../../errors/enum.RequestAttemptError.html" title="enum scylla::errors::RequestAttemptError">RequestAttemptError</a>,
)</h4></section></summary><div class="docblock"><p>Invoked each time a request fails.</p>
</div></details></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">ยง</a></h2><div id="implementors-list"><section id="impl-LoadBalancingPolicy-for-DefaultPolicy" class="impl"><a class="src rightside" href="../../../src/scylla/policies/load_balancing/default.rs.html#160-582">Source</a><a href="#impl-LoadBalancingPolicy-for-DefaultPolicy" class="anchor">ยง</a><h3 class="code-header">impl <a class="trait" href="trait.LoadBalancingPolicy.html" title="trait scylla::policies::load_balancing::LoadBalancingPolicy">LoadBalancingPolicy</a> for <a class="struct" href="struct.DefaultPolicy.html" title="struct scylla::policies::load_balancing::DefaultPolicy">DefaultPolicy</a></h3></section></div><script src="../../../trait.impl/scylla/policies/load_balancing/trait.LoadBalancingPolicy.js" async></script></section></div></main></body></html>