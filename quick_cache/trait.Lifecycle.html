<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Hooks into the lifetime of the cache items."><title>Lifecycle in quick_cache - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-6c3ea77c.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="quick_cache" data-themes="" data-resource-suffix="" data-rustdoc-version="1.86.0 (05f9846f8 2025-03-31)" data-channel="1.86.0" data-search-js="search-581efc7a.js" data-settings-js="settings-6dad6058.js" ><script src="../static.files/storage-3a5871a4.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-4d63596a.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../quick_cache/index.html">quick_<wbr>cache</a><span class="version">0.6.16</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Lifecycle</a></h2><h3><a href="#required-associated-types">Required Associated Types</a></h3><ul class="block"><li><a href="#associatedtype.RequestState" title="RequestState">RequestState</a></li></ul><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.begin_request" title="begin_request">begin_request</a></li><li><a href="#tymethod.on_evict" title="on_evict">on_evict</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.before_evict" title="before_evict">before_evict</a></li><li><a href="#method.end_request" title="end_request">end_request</a></li><li><a href="#method.is_pinned" title="is_pinned">is_pinned</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="index.html">In crate quick_<wbr>cache</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="index.html">quick_cache</a></div><h1>Trait <span class="trait">Lifecycle</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/quick_cache/lib.rs.html#148-191">Source</a> </span></div><pre class="rust item-decl"><code>pub trait Lifecycle&lt;Key, Val&gt; {
    type <a href="#associatedtype.RequestState" class="associatedtype">RequestState</a>;

    // Required methods
    fn <a href="#tymethod.begin_request" class="fn">begin_request</a>(&amp;self) -&gt; Self::<a class="associatedtype" href="trait.Lifecycle.html#associatedtype.RequestState" title="type quick_cache::Lifecycle::RequestState">RequestState</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.on_evict" class="fn">on_evict</a>(&amp;self, state: &amp;mut Self::<a class="associatedtype" href="trait.Lifecycle.html#associatedtype.RequestState" title="type quick_cache::Lifecycle::RequestState">RequestState</a>, key: Key, val: Val);

    // Provided methods
    fn <a href="#method.is_pinned" class="fn">is_pinned</a>(&amp;self, key: <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.reference.html">&amp;Key</a>, val: <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.reference.html">&amp;Val</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.bool.html">bool</a> { ... }
<span class="item-spacer"></span>    fn <a href="#method.before_evict" class="fn">before_evict</a>(
        &amp;self,
        state: &amp;mut Self::<a class="associatedtype" href="trait.Lifecycle.html#associatedtype.RequestState" title="type quick_cache::Lifecycle::RequestState">RequestState</a>,
        key: <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.reference.html">&amp;Key</a>,
        val: <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.reference.html">&amp;mut Val</a>,
    ) { ... }
<span class="item-spacer"></span>    fn <a href="#method.end_request" class="fn">end_request</a>(&amp;self, state: Self::<a class="associatedtype" href="trait.Lifecycle.html#associatedtype.RequestState" title="type quick_cache::Lifecycle::RequestState">RequestState</a>) { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Hooks into the lifetime of the cache items.</p>
<p>The functions should be small and very fast, otherwise the cache performance might be negatively affected.</p>
</div></details><h2 id="required-associated-types" class="section-header">Required Associated Types<a href="#required-associated-types" class="anchor">§</a></h2><div class="methods"><section id="associatedtype.RequestState" class="method"><a class="src rightside" href="../src/quick_cache/lib.rs.html#149">Source</a><h4 class="code-header">type <a href="#associatedtype.RequestState" class="associatedtype">RequestState</a></h4></section></div><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.begin_request" class="method"><a class="src rightside" href="../src/quick_cache/lib.rs.html#166">Source</a><h4 class="code-header">fn <a href="#tymethod.begin_request" class="fn">begin_request</a>(&amp;self) -&gt; Self::<a class="associatedtype" href="trait.Lifecycle.html#associatedtype.RequestState" title="type quick_cache::Lifecycle::RequestState">RequestState</a></h4></section></summary><div class="docblock"><p>Called before the insert request starts, e.g.: insert, replace.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.on_evict" class="method"><a class="src rightside" href="../src/quick_cache/lib.rs.html#180">Source</a><h4 class="code-header">fn <a href="#tymethod.on_evict" class="fn">on_evict</a>(&amp;self, state: &amp;mut Self::<a class="associatedtype" href="trait.Lifecycle.html#associatedtype.RequestState" title="type quick_cache::Lifecycle::RequestState">RequestState</a>, key: Key, val: Val)</h4></section></summary><div class="docblock"><p>Called when an item is evicted.</p>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.is_pinned" class="method"><a class="src rightside" href="../src/quick_cache/lib.rs.html#161-163">Source</a><h4 class="code-header">fn <a href="#method.is_pinned" class="fn">is_pinned</a>(&amp;self, key: <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.reference.html">&amp;Key</a>, val: <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.reference.html">&amp;Val</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Returns whether the item is pinned. Items that are pinned can’t be evicted.
Note that a pinned item can still be replaced with get_mut, insert, replace and similar APIs.</p>
<p>Compared to zero (0) weight items, pinned items still consume (non-zero) weight even if they can’t
be evicted. Furthermore, zero (0) weight items are separated from the other entries, which allows
having a large number of them without impacting performance, but moving them in/out or the evictable
section has a small cost. Pinning on the other hand doesn’t separate entries, so during eviction
the cache may visit pinned entries but will ignore them.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.before_evict" class="method"><a class="src rightside" href="../src/quick_cache/lib.rs.html#177">Source</a><h4 class="code-header">fn <a href="#method.before_evict" class="fn">before_evict</a>(&amp;self, state: &amp;mut Self::<a class="associatedtype" href="trait.Lifecycle.html#associatedtype.RequestState" title="type quick_cache::Lifecycle::RequestState">RequestState</a>, key: <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.reference.html">&amp;Key</a>, val: <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.reference.html">&amp;mut Val</a>)</h4></section></summary><div class="docblock"><p>Called when a cache item is about to be evicted.
Note that value replacement (e.g. insertions for the same key) won’t call this method.</p>
<p>This is the only time the item can change its weight. If the item weight becomes zero (0) it
will be left in the cache, otherwise it’ll still be removed. Zero (0) weight items aren’t evictable
and are kept separated from the other items so it’s possible to have a large number of them without
negatively affecting eviction performance.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.end_request" class="method"><a class="src rightside" href="../src/quick_cache/lib.rs.html#190">Source</a><h4 class="code-header">fn <a href="#method.end_request" class="fn">end_request</a>(&amp;self, state: Self::<a class="associatedtype" href="trait.Lifecycle.html#associatedtype.RequestState" title="type quick_cache::Lifecycle::RequestState">RequestState</a>)</h4></section></summary><div class="docblock"><p>Called after a request finishes, e.g.: insert, replace.</p>
<p>Notes:
This will <em>not</em> be called when using <code>_with_lifecycle</code> apis, which will return the RequestState instead.
This will <em>not</em> be called if the request errored (e.g. a replace didn’t find a value to replace).
If needed, Drop for RequestState can be used to detect these cases.</p>
</div></details></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><details class="toggle implementors-toggle"><summary><section id="impl-Lifecycle%3CKey,+Val%3E-for-DefaultLifecycle%3CKey,+Val%3E" class="impl"><a class="src rightside" href="../src/quick_cache/sync.rs.html#574-597">Source</a><a href="#impl-Lifecycle%3CKey,+Val%3E-for-DefaultLifecycle%3CKey,+Val%3E" class="anchor">§</a><h3 class="code-header">impl&lt;Key, Val&gt; <a class="trait" href="trait.Lifecycle.html" title="trait quick_cache::Lifecycle">Lifecycle</a>&lt;Key, Val&gt; for quick_cache::sync::<a class="struct" href="sync/struct.DefaultLifecycle.html" title="struct quick_cache::sync::DefaultLifecycle">DefaultLifecycle</a>&lt;Key, Val&gt;</h3></section></summary><div class="impl-items"><section id="associatedtype.RequestState-1" class="associatedtype trait-impl"><a class="src rightside" href="../src/quick_cache/sync.rs.html#580">Source</a><a href="#associatedtype.RequestState-1" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.RequestState" class="associatedtype">RequestState</a> = [<a class="enum" href="https://doc.rust-lang.org/1.86.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.tuple.html">(Key, Val)</a>&gt;; <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.array.html">2</a>]</h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Lifecycle%3CKey,+Val%3E-for-DefaultLifecycle%3CKey,+Val%3E-1" class="impl"><a class="src rightside" href="../src/quick_cache/unsync.rs.html#411-419">Source</a><a href="#impl-Lifecycle%3CKey,+Val%3E-for-DefaultLifecycle%3CKey,+Val%3E-1" class="anchor">§</a><h3 class="code-header">impl&lt;Key, Val&gt; <a class="trait" href="trait.Lifecycle.html" title="trait quick_cache::Lifecycle">Lifecycle</a>&lt;Key, Val&gt; for quick_cache::unsync::<a class="struct" href="unsync/struct.DefaultLifecycle.html" title="struct quick_cache::unsync::DefaultLifecycle">DefaultLifecycle</a>&lt;Key, Val&gt;</h3></section></summary><div class="impl-items"><section id="associatedtype.RequestState-2" class="associatedtype trait-impl"><a class="src rightside" href="../src/quick_cache/unsync.rs.html#412">Source</a><a href="#associatedtype.RequestState-2" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.RequestState" class="associatedtype">RequestState</a> = <a class="primitive" href="https://doc.rust-lang.org/1.86.0/std/primitive.unit.html">()</a></h4></section></div></details></div><script src="../trait.impl/quick_cache/trait.Lifecycle.js" async></script></section></div></main></body></html>